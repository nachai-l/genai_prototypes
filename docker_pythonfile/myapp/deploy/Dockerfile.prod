# syntax=docker/dockerfile:1

# ---- builder ----
FROM python:3.12-slim AS builder
WORKDIR /w
COPY requirements.txt .
RUN python -m venv /venv \
 && /venv/bin/pip install --no-cache-dir -r requirements.txt

# ---- runtime ----
FROM python:3.12-slim AS runtime
ENV PYTHONDONTWRITEBYTECODE=1 PYTHONUNBUFFERED=1
WORKDIR /app

# bring the prebuilt venv
COPY --from=builder /venv /venv
ENV PATH="/venv/bin:$PATH"

# app code
COPY app.py .
ENTRYPOINT ["python","-u","app.py"]
CMD ["--help"]
